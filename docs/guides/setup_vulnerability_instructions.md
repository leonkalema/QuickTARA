# Vulnerability Tables Setup for QuickTARA

## Overview

This guide explains how to set up the vulnerability tables in QuickTARA. The vulnerability assessment module allows you to:

1. Define vulnerabilities with CVSS scores and impact metrics
2. Map vulnerabilities to CWE and CVE references
3. Create vulnerability assessments for components
4. Track mitigation strategies
5. Generate vulnerability reports

## Quick Setup

Run the setup script:

```bash
# Make the script executable
chmod +x setup_vulnerability.sh

# Run the setup
./setup_vulnerability.sh
```

## Manual Setup

If you prefer to set up manually:

1. **Create vulnerability tables**:
   ```bash
   python db_create_vulnerability_tables.py
   ```

2. **Add initial vulnerability data**:
   ```bash
   python add_vulnerability_data.py
   ```

3. **Verify the setup**:
   ```bash
   python verify_vulnerability_setup.py
   ```

## Database Tables

The following tables will be created:

### vulnerabilities
- Core vulnerability definitions
- CVSS scores and metrics
- Attack vectors and impact scores

### vulnerability_cwe_mapping
- Maps vulnerabilities to CWE references
- Tracks relationship types (Direct, Related, etc.)

### vulnerability_cve_mapping
- Maps vulnerabilities to CVE references
- Includes CVE descriptions and dates

### vulnerability_assessments
- Links vulnerabilities to specific components
- Tracks likelihood and impact scores
- Records mitigation status

### vulnerability_mitigations
- Defines mitigation strategies
- Tracks effectiveness and implementation costs
- Records prerequisites

## Initial Data

The setup includes three sample vulnerabilities:

1. **VULN-001**: CAN Message Injection
   - CVSS: 7.8 (High)
   - Attack Vector: Adjacent
   - CWE mappings: CWE-20, CWE-287

2. **VULN-002**: Firmware Update Manipulation
   - CVSS: 9.1 (Critical)
   - Attack Vector: Network
   - CWE mappings: CWE-347, CWE-494

3. **VULN-003**: Diagnostic Interface Abuse
   - CVSS: 8.2 (High)
   - Attack Vector: Physical
   - CWE mappings: CWE-285, CWE-862

## Verification

After setup, you should see:

- All vulnerability tables created
- Sample data in the vulnerabilities table
- CWE mappings established
- Mitigation strategies defined

## Troubleshooting

1. **Tables already exist**: The script will skip table creation
2. **Data already loaded**: Sample data won't be duplicated
3. **Permission errors**: Ensure you have write access to the database
4. **Migration errors**: Check Alembic configuration

## Next Steps

1. Implement vulnerability scanning API
2. Create vulnerability UI components
3. Integrate with threat analysis
4. Generate vulnerability reports

For more information, refer to TASKS.md and the QuickTARA documentation.
