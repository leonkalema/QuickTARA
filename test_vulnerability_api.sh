#!/bin/bash
# Test vulnerability API endpoints (once implemented)

BASE_URL="http://localhost:8080/api"

echo "=== QuickTARA Vulnerability API Tests ==="
echo ""

# Test 1: Get all vulnerabilities
echo "1. Get all vulnerabilities"
curl -X GET "$BASE_URL/vulnerabilities"
echo -e "\n"

# Test 2: Get specific vulnerability
echo "2. Get vulnerability VULN-001"
curl -X GET "$BASE_URL/vulnerabilities/VULN-001"
echo -e "\n"

# Test 3: Get CWE mappings for a vulnerability
echo "3. Get CWE mappings for VULN-001"
curl -X GET "$BASE_URL/vulnerabilities/VULN-001/cwe"
echo -e "\n"

# Test 4: Get mitigations for a vulnerability
echo "4. Get mitigations for VULN-001"
curl -X GET "$BASE_URL/vulnerabilities/VULN-001/mitigations"
echo -e "\n"

# Test 5: Create a vulnerability assessment
echo "5. Create vulnerability assessment"
curl -X POST "$BASE_URL/vulnerability-assessments" \
  -H "Content-Type: application/json" \
  -d '{
    "component_id": "ECU001",
    "vulnerability_id": "VULN-001",
    "analysis_id": "analysis-1",
    "likelihood": 3,
    "impact": {
      "financial": 3,
      "safety": 4,
      "privacy": 2
    },
    "risk_level": "High",
    "mitigation_status": "Not Started",
    "detection_method": "Automated"
  }'
echo -e "\n"

echo "=== Tests completed ==="
echo "NOTE: These tests assume the API endpoints have been implemented."
echo "If you see 404 errors, the endpoints need to be created."
